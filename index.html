<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.1.9/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.1.9/addons/p5.sound.min.js"></script>
    <script src="https://unpkg.com/ml5@latest/dist/ml5.min.js"></script>
   <style>
       html, body {
  margin: 0;
  padding: 0;
}
canvas {
  display: block;
}

   </style>
    <meta charset="utf-8" />
</head>
<body>
    <Script>
        let video;
let poseNet;
let poses = [];

function setup() {
  createCanvas(windowWidth, windowHeight);
  let constraints = {
    video: {
      
      optional: [{ maxFrameRate: 60 }]
    },
    audio: false
  };
  video = createCapture(constraints);
  video.size(windowWidth, windowHeight);
  poseNet = ml5.poseNet(video);
  poseNet.on('pose', function(results) {poses = results;});
  video.hide();
}
function draw() {
  translate(windowWidth, 0);
  scale(-1, 1);
  canv = image(video, 0, 0, windowWidth, windowHeight);
drawSkeletonKeypoints();
}
function drawSkeletonKeypoints() {
	// Loop through all the skeletons detected
	for (let i = 0; i < poses.length; i++) {
		let skeleton = poses[i].skeleton;
		// For every skeleton, loop through all body connections
		for (let j = 0; j < skeleton.length; j++) {
			let partA = skeleton[j][0];
			let partB = skeleton[j][1];
			push();
			stroke('rgba(255,255,255, 0.5)');
			strokeWeight(2);
			line(partA.position.x, partA.position.y, partB.position.x, partB.position.y);
			pop();
		}
	}
  
  // Loop through all the poses detected
	for (let i = 0; i < poses.length; i++) {
		// For each pose detected, loop through all the keypoints
		let pose = poses[i].pose;
		for (let j = 0; j < pose.keypoints.length; j++) {
			// A keypoint is an object describing a body part (like rightArm or leftShoulder)
			let keypoint = pose.keypoints[j];
			// Only draw an ellipse is the pose probability is bigger than 0.2
			if (keypoint.score > 0.5) {
				push();
				fill('rgba(255,255,255, 0.5)');
				noStroke();
				ellipse(keypoint.position.x, keypoint.position.y, 10, 10);
				pop();
			}
		}
	}
}

    </Script>
</body>
</html>
